services:
    ds_service.service.service:
        class: Ds\Bundle\ServiceBundle\Service\ServiceService

    ds_service.service.category:
        class: Ds\Bundle\ServiceBundle\Service\CategoryService

    ds_service.service.scenario:
        class: Ds\Bundle\ServiceBundle\Service\ScenarioService

    ds_service.service.submission:
        class: Ds\Bundle\ServiceBundle\Service\SubmissionService

    ds_service.filter.service:
        parent: api_platform.doctrine.orm.search_filter
        arguments:
            - { uuid: exact }
        tags:
            - { name: api_platform.filter, id: ds_service.filter.service }

    ds_service.filter.category:
        parent: api_platform.doctrine.orm.search_filter
        arguments:
            - { uuid: exact }
        tags:
            - { name: api_platform.filter, id: ds_service.filter.category }

    ds_service.filter.scenario:
        parent: api_platform.doctrine.orm.search_filter
        arguments:
            - { uuid: exact }
        tags:
            - { name: api_platform.filter, id: ds_service.filter.scenario }

    ds_service.filter.submission:
        parent: api_platform.doctrine.orm.search_filter
        arguments:
            - { uuid: exact }
        tags:
            - { name: api_platform.filter, id: ds_service.filter.submission }

    ds_service.form.flow.formio:
        parent: craue.form.flow
        class: Ds\Bundle\ServiceBundle\Form\Flow\FormioFlow

    ds_service.form.flow.formio.factory:
        class: Ds\Bundle\ServiceBundle\Form\Flow\Formio\Factory
        arguments:
            - '@ds_service.form.flow.formio'

    ds_service.event_listener.submission.validation.formio:
        class: Ds\Bundle\ServiceBundle\EventListener\Submission\Validation\FormioListener
        arguments:
            - '@service_container'
            - '@ds_formio.api'
            - '@ds_config.service.config'
            - '@api_platform.hydra.normalizer.constraint_violation_list'
        tags:
            - { name: kernel.event_listener, event: kernel.view, method: kernelView, priority: 64 }

    ds_service.event_listener.submission.owner:
        class: Ds\Bundle\ServiceBundle\EventListener\Submission\OwnerListener
        tags:
            - { name: doctrine.orm.entity_listener, entity: Ds\Bundle\ServiceBundle\Entity\Submission, event: prePersist }

    ds_service.event_listener.submission.delegation.bpm:
        class: Ds\Bundle\ServiceBundle\EventListener\Submission\Delegation\BpmListener
        arguments:
            - "@service_container"
        tags:
            - { name: doctrine.orm.entity_listener, entity: Ds\Bundle\ServiceBundle\Entity\Submission, event: postPersist }
